@if (TempData["ErrorMessage"] != null)
{
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4" role="alert">
        <p class="font-bold">Greška!</p>
        <p class="text-sm">@TempData["ErrorMessage"]</p>
    </div>
}
@if (TempData["SuccessMessage"] != null)
{
    <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4" role="alert">
        <p class="font-bold">Uspjeh!</p>
        <p class="text-sm">@TempData["SuccessMessage"]</p>
    </div>
}

@model Dictionary<string, object>
@{
    ViewData["Title"] = "Dijagnostika notifikacija";
}

<div class="max-w-4xl mx-auto py-8">
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden mb-6">
        <div class="border-b border-gray-200 dark:border-gray-700 px-6 py-4">
            <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Dijagnostika notifikacija</h1>
        </div>

        <div class="p-6">
            <h2 class="text-xl font-semibold mb-4">Sažetak</h2>
            <p class="mb-2">Ukupno notifikacija: @Model["UkupnoNotifikacija"]</p>

            <h3 class="text-lg font-semibold mt-4 mb-2">Notifikacije po tipu:</h3>
            <ul class="list-disc pl-5 mb-4">
                @foreach (var grupa in (IEnumerable<dynamic>)Model["GrupeNotifikacija"])
                {
                    <li>@grupa.Tip: @grupa.Broj</li>
                }
            </ul>

            <h3 class="text-lg font-semibold mt-6 mb-2">Zadnjih 5 notifikacija:</h3>
            <table class="min-w-full border-collapse">
                <thead>
                    <tr class="bg-gray-100 dark:bg-gray-700">
                        <th class="p-2 border text-left">ID</th>
                        <th class="p-2 border text-left">Korisnik</th>
                        <th class="p-2 border text-left">Tip</th>
                        <th class="p-2 border text-left">Naslov</th>
                        <th class="p-2 border text-left">Datum</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (Notifikacija n in (IEnumerable<Notifikacija>)Model["ZadnjihPet"])
                    {
                        <tr class="border-t hover:bg-gray-50 dark:hover:bg-gray-700">
                            <td class="p-2 border">@n.NotifikacijaID</td>
                            <td class="p-2 border">@n.KorisnikID</td>
                            <td class="p-2 border">@n.Tip</td>
                            <td class="p-2 border">@n.Naslov</td>
                            <td class="p-2 border">@n.DatumKreiranja.ToString("g")</td>
                        </tr>
                    }
                </tbody>
            </table>

            <h3 class="text-lg font-semibold mt-6 mb-2">Notifikacije izazova (zadnjih 10):</h3>
            @if (((IEnumerable<Notifikacija>)Model["IzazovNotifikacije"]).Any())
            {
                <table class="min-w-full border-collapse">
                    <thead>
                        <tr class="bg-gray-100 dark:bg-gray-700">
                            <th class="p-2 border text-left">ID</th>
                            <th class="p-2 border text-left">Korisnik</th>
                            <th class="p-2 border text-left">Naslov</th>
                            <th class="p-2 border text-left">Sadržaj</th>
                            <th class="p-2 border text-left">Datum</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (Notifikacija n in (IEnumerable<Notifikacija>)Model["IzazovNotifikacije"])
                        {
                            <tr class="border-t hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="p-2 border">@n.NotifikacijaID</td>
                                <td class="p-2 border">@n.KorisnikID</td>
                                <td class="p-2 border">@n.Naslov</td>
                                <td class="p-2 border">@n.Sadrzaj</td>
                                <td class="p-2 border">@n.DatumKreiranja.ToString("g")</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
            else
            {
                <p class="text-gray-500 dark:text-gray-400">Nema notifikacija izazova.</p>
            }
        </div>
    </div>

    <div class="mt-6">
        <a href="@Url.Action("TestNotifikacija")" class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded mr-2">
            Kreiraj test notifikaciju
        </a>
        <a href="@Url.Action("Index")" class="bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded">
            Povratak na notifikacije
        </a>
    </div>
</div>
